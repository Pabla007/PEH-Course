<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Discovering Hosts with SMB Signing Disabled</title>
</head><body>Have to identify what has SMB signing disabled and what has SMB signing enabled <br/>
<br/>
One way to do it is Nessus Scan and the other way is to use Nmap and run a specific script that is build in.<br/>
<br/>
<b>Command : nmap --script=smb2-security-mode.nse -p445 192.168.205.0/24<br/>
</b><br/>
──(root㉿kali)-[/home/kali]<br/>
└─# nmap --script=smb2-security-mode.nse -p445 192.168.205.0/24 <br/>
Starting Nmap 7.92 ( https://nmap.org ) at 2023-03-06 13:03 IST<br/>
Nmap scan report for 192.168.205.1<br/>
Host is up (0.00065s latency).<br/>
<br/>
PORT  STATE  SERVICE<br/>
445/tcp filtered microsoft-ds<br/>
MAC Address: 00:50:56:C0:00:08 (VMware)<br/>
<br/>
Nmap scan report for 192.168.205.2<br/>
Host is up (0.00042s latency).<br/>
<br/>
PORT  STATE SERVICE<br/>
445/tcp closed microsoft-ds<br/>
MAC Address: 00:50:56:E9:84:98 (VMware)<br/>
<br/>
Nmap scan report for 192.168.205.137<br/>
Host is up (0.00094s latency).<br/>
<br/>
PORT  STATE SERVICE<br/>
445/tcp open microsoft-ds<br/>
MAC Address: 00:0C:29:7A:7C:58 (VMware)<br/>
<br/>
<b><span style="background-color: #ff0000">Windows Server : 192.168.205.137</span></b><br/>
<span style="background-color: #ffff99">Host script results:<br/>
| smb2-security-mode: <br/>
|  3.1.1: <br/>
</span><span style="background-color: #ffff99">|_  Message signing enabled and required</span><br/>
<br/>
Nmap scan report for 192.168.205.138<br/>
Host is up (0.00056s latency).<br/>
<br/>
PORT  STATE SERVICE<br/>
445/tcp open microsoft-ds<br/>
MAC Address: 00:0C:29:00:36:05 (VMware)<br/>
<br/>
<b><span style="background-color: #ffa300">fcastle 192.168.205.138</span></b><br/>
<span style="background-color: #ffff99">Host script results:<br/>
| smb2-security-mode: <br/>
|  3.1.1: <br/>
|_  Message signing enabled but not required<br/>
</span><br/>
Nmap scan report for 192.168.205.141<br/>
Host is up (0.00043s latency).<br/>
<br/>
PORT  STATE SERVICE<br/>
445/tcp open microsoft-ds<br/>
MAC Address: 00:0C:29:F1:C9:BF (VMware)<br/>
<br/>
<b><span style="background-color: #ffa300">parker 192.168.205.141</span></b><br/>
<span style="background-color: #ffff99">Host script results:<br/>
| smb2-security-mode: <br/>
|  3.1.1: <br/>
</span><span style="background-color: #ffff99">|_  Message signing enabled but not required</span><br/>
<br/>
Nmap scan report for 192.168.205.254<br/>
Host is up (0.00078s latency).<br/>
<br/>
PORT  STATE  SERVICE<br/>
445/tcp filtered microsoft-ds<br/>
MAC Address: 00:50:56:F5:9B:EC (VMware)<br/>
<br/>
Nmap scan report for 192.168.205.128<br/>
Host is up (0.000050s latency).<br/>
<br/>
PORT  STATE SERVICE<br/>
445/tcp open microsoft-ds<br/>
<br/>
Host script results:<br/>
| smb2-security-mode: <br/>
|  2.0.2: <br/>
|_  Message signing enabled but not required<br/>
<br/>
Nmap done: 256 IP addresses (7 hosts up) scanned in 7.40 seconds<br/>
<br/>
- Message Signing is disabled by default in any workstation but is and enabled and required on every single server by default.<br/>
<br/>
Will make a txt file named targets.txt and will add the Ip address of Peter Parker's machine. (i.e. 192.168.205.141)<br/>
But in perfect world scenario will put all the machines in here but for the attack will only add the Peter Parker's ip address to simplify for the attack.<br/>
<br/>
</body></html>