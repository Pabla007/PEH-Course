<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>SQL Injection - UNION
</title>
</head><body>First will start the lab up from the docker:<br/>
to run the docker in the background than just add -d in the end.<br/>
sudo docker-compose up<br/>
<br/>
Open Web-browser <br/>
http://localhost<br/>
<br/>
<img height="254" src="image.png" width="750"/><br/>
<br/>
Will pass some data and see what the sql database send us.<br/>
<img height="197" src="image 2.png" width="700"/><br/>
<b>Step 1: Single and Double quotes</b><br/>
Here is some basic applciation that searches or queries the database.<br/>
<br/>
Will send some basic payload like Jeremy which will return some results:<br/>
<br/>
When u are assessing applications, it's important to try and take a little bit of time to understand what is the intention of the application, what did the developers have in mind for each piece of functionality and figure out how it works.<br/>
<br/>
To test if we have injection, we can start with characters that might trigger an error such as single and double quotes.<br/>
<br/>
<br/>
We passed jeremy with sinhle and double quotes but didn't got any errir regarding it.<br/>
But why would this will trigger an error ?_?<br/>
Cuz often SQL queries are formed using single and double quotes<br/>
and sending this characters can break the SQL statement and throw a database error which sometimes is printed back to us.<br/>
<br/>
<br/>
<b>Step 2: Logical Operators</b><br/>
Command: jeremy' 1=1#<br/>
<img height="234" src="image 3.png" width="750"/><br/>
<br/>
If we use <br/>
jeremy' or 1=1# <br/>
at the end will use the terminator # aka pound sign or we can even use<br/>
jeremy' or 1=1-- -<br/>
<br/>
So now we know that this application is vulnerable to sql injection.<br/>
As we know the backend is using MySQL and every database has different <br/>
payload and the mentor will share a cheat sheet later on to see that if we are working with Postgres or Oracle or Microsoft SQL Server.<br/>
<br/>
<img height="172" src="image 4.png" width="650"/><br/>
<br/>
We are sure now that the application is Vulnerable to<b>SQL injection</b><br/>
<br/>
<b>UNION</b><br/>
Now will look how we can exfiltrate some other informaion out of the database.<br/>
And will be using the keyword Union as this information will retrive information from other tables and columns that were not initially defined.<br/>
<br/>
There is <span style="background-color: #ffa300"><b>one Constraint</b></span>however when we union select we can only select the same number of columns as in the original query.<br/>
<br/>
<b>Now we can see that 3 columns are being selected</b><br/>
<img height="199" src="image 5.png" width="650"/><br/>
We can pass the version() to get the Sql version<br/>
<img height="173" src="image 6.png" width="650"/><br/>
There is more information being selected in the background but we are only able to some as the output.<br/>
Command: jeremy' union select null,null,table_name from information_schema.tables#<br/>
<br/>
<img height="350" src="image 7.png" width="600"/><br/>
<br/>
<br/>
<br/>
We got all the table names but we also want to know the column names<br/>
Command: jeremy' union select null,null,column_name from information_schema.columns#<br/>
<br/>
<img height="406" src="image 8.png" width="700"/><br/>
<br/>
<br/>
Now will select jeremy's password:<br/>
Command: jeremy' union select null,null,password from injection0x01#<br/>
<br/>
<img height="203" src="image 9.png" width="600"/><br/>
As we can see here it's not just selecting Jeremy's password but it selects all the passwords from that column.<br/>
<br/>
<span style="background-color: #ffa300"><b>Now there is one more constraint </b></span><br/>
We can select other data of the same type, but let's say each user had an id instead of a string. And 1st one is an int instead of a string so the email address is probably stored as a string, ID is stored as an integer.<br/>
<br/>
If you try a union select a string into a column that's an integer you are going to get an error.<br/>
<img height="192" src="image 10.png" width="700"/><br/>
<br/>
<a href="https://portswigger.net/web-security/sql-injection/cheat-sheet">https://portswigger.net/web-security/sql-injection/cheat-sheet</a><br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
<br/>
</body></html>