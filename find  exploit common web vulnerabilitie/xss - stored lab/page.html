<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>XSS - Stored Lab</title>
</head><body>Set up containers for our testing and this allows us to have multiple sessions open and test across different user accounts.<br/>
<br/>
Mentor uses it for testing authorization issues:<br/>
to see if we can update Bob's account using Alice's session token.<br/>
<br/>
But here will check if the CSS is indeed stored and not just showing up for the same user that post the payload.<br/>
<br/>
Search Firefox containers<br/>
<a href="https://addons.mozilla.org/en-US/firefox/addon/multi-account-containers/">https://addons.mozilla.org/en-US/firefox/addon/multi-account-containers/</a><br/>
<br/>
<br/>
<img height="245" src="image.png" width="700"/><br/>
<br/>
We have 4 containers to begin with:<br/>
Click Manage Containers and will make 2 containers<br/>
<br/>
On Mentor's Pentest Machine he has <br/>
2 low privileged users and<br/>
2 high privilege users <br/>
<br/>
We can see the cookie that we have made<br/>
<img height="316" src="image 2.png" width="700"/><br/>
<br/>
<img height="190" src="image 3.png" width="450"/><br/>
<br/>
Something that you might want to consider is that when testing for cross site scripting you can test for HTML injection first.<br/>
<br/>
That's because HTML injection is more likely to work and than once you find that, you might need to figure out how you can get your cross site scripting payload to work if there's some kind of filtering or some restricted characters.<br/>
<br/>
command: &lt;h1&gt;Test&lt;/h1&gt;<br/>
we do have html injection here.<br/>
<br/>
<img height="278" src="image 4.png" width="700"/><br/>
<br/>
command: &lt;script&gt;prompt(1)&lt;/script&gt;<br/>
Here the page reloaded when we submitted the input it's then rendered to the page and then as the page loads, it's executed.<br/>
<br/>
And to prove that it's stored we can come over to our second container, and click refresh to see it.<br/>
<br/>
<img height="252" src="image 5.png" width="650"/><br/>
<br/>
<br/>
command: &lt;script&gt;alert(document.cookie)&lt;/script&gt;<br/>
will try to alert the cookie in the 2nd container and see the result in the 1st container.<br/>
<br/>
Best Practise is the set the cooikes to HTTP only, which is a flag that prevents JavaScript from accessing your cookie.<br/>
<img height="317" src="image 6.png" width="700"/><br/>
<br/>
<img height="391" src="image 7.png" width="750"/><br/>
<br/>
<br/>
<br/>
<br/>
<br/>
</body></html>